System.register(["./chunk-vendor.js","./chunk-frameworks.js"],(function(e,t){"use strict";var n,o,r,s;return{setters:[function(e){n=e.a,o=e.o,r=e.k},function(e){s=e.C}],execute:function(){function e(e){const t=document.createElement("input");return t.setAttribute("type","hidden"),t.setAttribute("name",e.name),t.setAttribute("value",e.value),t}n("change",".js-scanning-alert-check",(function({currentTarget:t}){const n=t.closest(".js-scanning-alert-list"),o=null!=n.querySelector(".js-scanning-alert-check:checked"),r=n.querySelector(".js-scanning-filter-options"),s=n.querySelector(".js-scanning-alert-bulk-actions"),c=n.querySelector(".js-scanning-alert-links");r&&(r.hidden=o),s&&(s.hidden=!o),c&&(c.hidden=o),function(t){let n=!1;const o=t.querySelectorAll(".js-scanning-fixed-alert-numbers"),r=0!==o.length?JSON.parse(o[0].getAttribute("data-numbers")||"[]"):[];for(const s of t.querySelectorAll(".js-scanning-bulk-action-items")){s.innerHTML="";const o=t.querySelectorAll(".js-scanning-alert-list [data-check-all-item]:checked");for(const t of o)n||(n=-1!==r.indexOf(parseInt(t.value))),s.appendChild(e(t))}for(const e of t.querySelectorAll(".js-scanning-reopen-button"))e.hidden=n;for(const e of t.querySelectorAll(".js-scanning-reopen-button-disabled"))e.hidden=!n}(n)})),n("details-menu-selected",".js-scanning-code-path-menu",(function(e){const t=e.detail.relatedTarget.getAttribute("data-target-code-path");for(const n of document.querySelectorAll(".js-scanning-code-path"))n.hidden=t!==n.getAttribute("data-code-path")}),{capture:!0}),o(".js-add-secret-format-button",{add(){window.postProcessingExpressionCount=0;const e=document.querySelector(".js-post-processing-expression-count");e&&e.textContent&&(window.postProcessingExpressionCount=parseInt(e.textContent))}}),n("click",".js-add-secret-format-button",(e=>{const t=e.currentTarget;if(t&&window.postProcessingExpressionCount<l()){const e=document.querySelectorAll(".js-additional-secret-format");if(!e)return;for(const n of e)if(n.classList.contains("has-removed-contents")){n.classList.toggle("has-removed-contents",!1),window.postProcessingExpressionCount++,window.postProcessingExpressionCount===l()&&(t.hidden=!0);break}}})),n("click",".js-remove-secret-format-button",(e=>{const t=document.querySelector(".js-add-secret-format-button");if(!t)return;const n=e.currentTarget;if(!n)return;const o=n.closest(".js-additional-secret-format");if(!o)return;o.classList.toggle("has-removed-contents",!0);o.getElementsByClassName("js-post-processing-input")[0].value="";const r=o.getElementsByClassName("errored")[0];r&&(r.classList.toggle("errored",!1),i(window.codeEditor.getValue())),window.postProcessingExpressionCount--,window.postProcessingExpressionCount<l()&&(t.hidden=!1)})),o(".js-test-code",{async add(){const e=document.querySelector(".js-test-code"),n=e.clientHeight,o=await t.import("./chunk-codemirror.js");if(window.codeEditor=o.default.fromTextArea(e,{lineNumbers:!1,lineWrapping:!0,mode:"text/x-yaml",inputStyle:"contenteditable",value:e.value,lineSeparator:"\r\n",theme:"github-light"}),0!==n){const e=document.querySelector(".CodeMirror");e&&(e.style.height=n+"px",e.style.width="640px",e.style.border="1px solid #e1e4e8",e.style.borderRadius="6px")}window.codeEditor.save(),window.codeEditor.on("change",(()=>{i(window.codeEditor.getValue())}))}}),s(".js-custom-secret-scanning-pattern-form *",(async function(e){if(!window.codeEditor)return;const t=e.currentTarget;i(window.codeEditor.getValue(),t)}));const c=(e,t,n)=>{const o=document.createElement("input");o.type="hidden",o.name=t,o.id=t,o.value=n,e.appendChild(o),o.required=!0},i=r((function(e,t){const n=document.querySelector(".js-custom-pattern-submit-button");if(!(n instanceof HTMLElement))return;const o=document.querySelector(".js-update-pattern-info");if(t&&"display_name"===t.id&&o)return void n.removeAttribute("disabled");const r=document.querySelector(".js-test-pattern-matches");if(r)if(0===e.length)n.setAttribute("disabled","true"),r.textContent="";else{window.codeEditor.save();const e=document.querySelector(".js-test-custom-secret-scanning-pattern");if(!(e instanceof HTMLFormElement))return;const t=document.querySelector(".js-custom-secret-scanning-pattern-form");if(!(t instanceof HTMLFormElement))return;for(const n of t.elements)n instanceof HTMLInputElement&&n.name&&("text"===n.type||"radio"===n.type&&n.checked)&&c(e,n.name,n.value);!async function(e,t,n){let o;try{const t=await fetch(e.action,{method:e.method,body:new FormData(e),headers:{Accept:"application/json"}});t.ok&&(o=await t.json())}catch(r){}if(o&&t(o.error))if(o.has_matches){const e=JSON.parse(o.matches);f(),n(e);for(const t of e){const e=window.codeEditor.posFromIndex(t.start),n=window.codeEditor.posFromIndex(t.end);window.codeEditor.markText(e,n,{className:"bg-yellow-2"})}}else n([]),f()}(e,d(t,n,o),a(r))}}),300),a=e=>t=>{if(0===t.length)e.textContent=" - No matches";else if(1===t.length)e.textContent=" - 1 match";else{const n=[];for(const e of t)n.push(JSON.stringify(e));const o=[...new Set(n)];e.textContent=` - ${o.length} matches`}},d=(e,t,n)=>o=>{if(function(e){var t,n;document.querySelector(".js-error-banner").hidden=!0;for(const o of e.getElementsByTagName("input"))if(null===(t=o.parentElement)||void 0===t?void 0:t.classList.contains("errored")){m(o.parentElement);const e=o.getAttribute("aria-describedby");null===(n=document.querySelector("#"+e))||void 0===n||n.remove()}}(e),null==o?void 0:o.message){if(t.setAttribute("disabled","true"),n)n.hidden=!0;else if("START_DELIMITER"===(null==o?void 0:o.error_type)||"END_DELIMITER"===(null==o?void 0:o.error_type)||"MUST_MATCH"===(null==o?void 0:o.error_type)||"MUST_NOT_MATCH"===(null==o?void 0:o.error_type)){const e=document.querySelector(".js-more-options.js-details-container");e&&(e.classList.add("open"),e.classList.add("Details--on"))}return function(e,t){var n;if("MUST_MATCH"===t.error_type||"MUST_NOT_MATCH"===t.error_type){let o=0;const r=e.getElementsByClassName("js-additional-secret-format");for(const e of r){if(o>(t.error_index||0))return;const r=[...e.getElementsByTagName("input")].filter((e=>e.checked)),s=r&&(null===(n=r[0])||void 0===n?void 0:n.value.toUpperCase()),c=s===t.error_type&&o===t.error_index,i=[...e.getElementsByTagName("input")].filter((e=>"text"===e.type));if(!i||0===i.length)continue;const a=i[0];if(""!==a.value){if(c){const e=a.id;a&&a.parentElement&&u(a.parentElement);const n=document.createElement("p"),o=e+"_error_message";return n.classList.add("note","error","mt-5"),n.id=o,n.textContent=t.message,null==a||a.setAttribute("aria-describedby",o),void(null==a||a.insertAdjacentElement("afterend",n))}s===t.error_type&&o++}}}else{const e=p[t.error_type],n=document.querySelector("#"+e);n&&n.parentElement&&u(n.parentElement);const o=document.createElement("p"),r=e+"_error_message";o.classList.add("note","error"),o.id=r,o.textContent=t.message,null==n||n.setAttribute("aria-describedby",r),null==n||n.insertAdjacentElement("afterend",o)}}(e,o),!1}return t.removeAttribute("disabled"),n&&(n.hidden=!1),!0};function l(){const e=document.querySelector(".js-post-processing-expression-max-count");if(!e)return 5;const t=e.textContent;return t?parseInt(t):5}function u(e){null==e||e.classList.add("form-group","errored","my-0")}function m(e){null==e||e.classList.remove("form-group","errored","my-0")}function f(){if(!window.codeEditor)return;const e=window.codeEditor.posFromIndex(0),t=window.codeEditor.posFromIndex(window.codeEditor.getValue().length);for(const n of window.codeEditor.findMarks(e,t))n.clear()}const p={NONE:"",CONFIG_LOAD:"secret_format",COMPILE_DB:"secret_format",START_DELIMITER:"before_secret",END_DELIMITER:"after_secret",DISPLAY_NAME:"display_name"}}}}));
//# sourceMappingURL=scanning-e0830ad4.js.map
